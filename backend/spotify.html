<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Use the Spotify API | Social Playlist</title>
    <meta name="description" content="Springboot &amp; Angular Hands-on Workshop">
    
    
    <link rel="preload" href="/social-playlist/assets/css/0.styles.a5234e6a.css" as="style"><link rel="preload" href="/social-playlist/assets/js/app.41029deb.js" as="script"><link rel="preload" href="/social-playlist/assets/js/2.5ad4ca2f.js" as="script"><link rel="preload" href="/social-playlist/assets/js/3.f00a2576.js" as="script"><link rel="prefetch" href="/social-playlist/assets/js/10.9a624b33.js"><link rel="prefetch" href="/social-playlist/assets/js/11.b7ea0b1a.js"><link rel="prefetch" href="/social-playlist/assets/js/4.0cee2806.js"><link rel="prefetch" href="/social-playlist/assets/js/5.7495ea5b.js"><link rel="prefetch" href="/social-playlist/assets/js/6.ba8a17b8.js"><link rel="prefetch" href="/social-playlist/assets/js/7.1936ba72.js"><link rel="prefetch" href="/social-playlist/assets/js/8.140ef7cd.js"><link rel="prefetch" href="/social-playlist/assets/js/9.f8d5f274.js">
    <link rel="stylesheet" href="/social-playlist/assets/css/0.styles.a5234e6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/social-playlist/" class="home-link router-link-active"><!----> <span class="site-name">Social Playlist</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/lakermann/social-playlist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/lakermann/social-playlist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/social-playlist/" class="sidebar-link">Introduction</a></li><li><a href="/social-playlist/backend/first-spring-boot-application.html" class="sidebar-link">First Spring Boot application</a></li><li><a href="/social-playlist/frontend/first-angular-application.html" class="sidebar-link">First Angular Application</a></li><li><a href="/social-playlist/backend/spotify.html" class="active sidebar-link">Use the Spotify API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/social-playlist/backend/spotify.html#set-up-your-developer-account" class="sidebar-link">Set up your developer account</a></li><li class="sidebar-sub-header"><a href="/social-playlist/backend/spotify.html#architecture" class="sidebar-link">Architecture</a></li><li class="sidebar-sub-header"><a href="/social-playlist/backend/spotify.html#login-to-the-spotify-web-api" class="sidebar-link">Login to the Spotify Web API</a></li><li class="sidebar-sub-header"><a href="/social-playlist/backend/spotify.html#get-all-tracks-of-a-playlist-from-spotify" class="sidebar-link">Get all tracks of a playlist from Spotify</a></li></ul></li><li><a href="/social-playlist/frontend/consuming-the-rest-api.html" class="sidebar-link">Consuming the REST API</a></li><li><a href="/social-playlist/automatic-login-on-first-page-visit.html" class="sidebar-link">Automatic login on first page visit</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="use-the-spotify-api"><a href="#use-the-spotify-api" aria-hidden="true" class="header-anchor">#</a> Use the Spotify API</h1> <p>There are various possibilities to integrate the Spotify API into your own application.
We could either access directly the REST endpoints or use a wrapper API.
In this chapter you will learn how to connect to the Spotify API using a Java wrapper.</p> <h2 id="set-up-your-developer-account"><a href="#set-up-your-developer-account" aria-hidden="true" class="header-anchor">#</a> Set up your developer account</h2> <p>Prior to using the Spotify API you have to create a developer account. Navigate to <a href="https://developer.spotify.com/dashboard/" target="_blank" rel="noopener noreferrer">https://developer.spotify.com/dashboard/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and log in with your account. Create a new app.</p> <p><img src="/social-playlist/assets/img/spotifydashboard.cf877695.png" alt="Create a new application on the Spotify Dashboard"></p> <p>Select <code>No</code> when asked if you want to develop a commercial integration.
You have to agree to the license agreements in order to use the API.</p> <p>On the next page you can now look up your Client ID and secret, which are needed for accessing the Spotify API from your application.</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcYAAADsCAYAAADuIgbNAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACafSURBVHhe7d3fixzXnffx5z+Q9cO2rGSzJHmCIZhez2ZDSMgsg3lMHieeIMw2eli87IKH9YN2MCEMImbQ8pjBIWbwgpkoKIMx8jBEbNvEeBRiRheG0Y0YXwhaF6J1IWhdGPpCF30h6Iu5+D7n1I/uU6dOnVPdPdXTPXofeMFMd/3uqvPpU1Wn+n+cOHFCAABAjGAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWB8UlzYkN37XekdSFy6bdm7siQ117DADKj9uiHNr7vJDi3Se9SSxqV557DAMAjGJ8GFLWn1ktojU3rS/mTZPQ4wxWqX92QQiWbpyv77Nec4QFkE47FXk427zlRMSlsa513jFVhYlvXre9JS39R79mTVC927W7LkGg9eW/eTbegq97ec4xwbbxeFnC5d2XvbHmdZdjvJ267yeF/WMsMDwyEYj70NaaanTwtK+7NFx3i2eVm53pJuYFrS3ZNV5/jwIRiLiiMY39wVXy7qMyH771njAEMgGI+9LWkl1UVR6d5adYxnqsvm3eKqK1MIxpEQjEXFEYze4ePS2rbGAYZAMM6IwoozGETjtxiXv/B/P88UgnEkBGNRmaEW43bRV1DX6WBMM4JxRowejGNeYzyvWpyh06dmIRhHQjAWlRm6xkgwHhsE44wYPRiVMe5KXfyknQxbshCMIyEYi4o7VKbyrlSC8dggGGfEWMGojdiPceNuMnxB6d5ryNqFQd+x+VcX6Rs5AoKxqBSHytT1YyQYjw2CcSasyl5RzVFxC81bYX+9I3XHOBgewVhUZidUVm8VHqQE44whGGdA7UpTCq8SVhqMK7L3KJmPo4TvZkVZBGNRmZFQmduQZvFBSjDOGIJxmi3UZS3Ud7DSYPS0VFUhGA8PwVhUpj1U5qX+TkNanuOEYJw9kw/GuUVZvbYnzYcFT0552JS9a6uyOOcYN8PXP8/YEeeWZP3GfvykFitgeo+70r69K5uXx78uNn9hTTZvJvMpWq/r67L8avjGgOJTMuWKHVje6VnBOu689fS+CE3jQUMWjXkWW5TGg2QcZ2nLzgXXeOPxhdRg29Zk6b0d2b/fka7z896X3atl9uPYYQRj7dXV4n3woBfv73f2ZOudusw7xtcWC6+TJWWIOz7Xbhc2oVTRXSqSY2GEYBx7e+knOHnqhc79fdl5f7lwO/mXuUSp+BIIxjPBYCz55JS0HHSldX3FE1ihYKwNN78RL9zPX2pIs+OrAPKle29H1t8oDshZD8bVYBePjuxeHMyzUKi/2t3NSm70CQWjvunD30IwSrIfF1awibEq+oUVadwb8nN7XHTzlf8sgS7Nq2Xu+gz0n+3synI67CSDUX1R3rjVLr40YRe9nT6o56dDMB5rEwrGumzdGy480tJVlZ/7Bg9/MLbvj7Lb9lQlVvYXJ+rqAOuUP8BypTj4Zz4Y1XT8rQW1pb9aD27n5Zu+WCwZriPwBuMD9WUr+XuY0rvXkCVP63HUin7+XfXlYfSdUDq3N3LHV7CLzsPwTVe1q81kYHfJhOukgnFOhf4Qz6oYlJ50vlBfiMxpEYzH2gSCsXYoFX2+EvUF4zhFheO24xuiSX3rbNwfozYySvfWWq41cRyC8cT5hvir19DDy9dk/3EyqKuUPh07PG+lO0bpqQq7KFBGqeiL+/INV/LHV2Dbq2Nk/11zeFvgFLh9OnYiwai+nI91zFr1AsF4rFUfjOPuQFFxtQ6qCkZdfK2RcQ+wfLErpmMRjEqo1di5WfxwgaFaHIesqmDUpfOFe52Hrujn1gPhNUzJ7+/BVqPvNPZF/ynw3Oc+gWAMXjstU3pN2Uhb/QTjsVZ5MK5/VVw5du9syWpyM4q+cWDrTvGu1ru9Zk27ymBUpaBFUr8+5JNgShV18F8eVPTHJRhPXNjxtxpVy2HdeXox0OIwr09VoMpgLGopD13RD/tEokDJHV/B4C2+8cn7heigKZv2Z155MC7KzsPkvVzpSfvmuiwvxMPOX1yX3QfFy9/+JHmuMMF4rFUcjJ5+cM4do15cIT7ak5XMsBUHo6vV6O2rNGYxKvujDMascbtrhJ7TalQ0pkCLIzfOGJWU61cYqg1GR4spNM+hKnpVeh3Zv7Ym9aSy13eCvx7qUuDYD0IPj89/WVXmNr033TjHqTwYPXWF+gKca/nqa5FFC3QvmTbBeKxVHIyeHeygJZvpgWvSndn1reWP2tK6syc71zdl7c2lwUHeVzIYuy3ZU5XE62k3iaiS2JK9Ejfn2AdxmW/pvYf70nh/pb+8tVdfl7WruyXuYvRct/GdBipxgB1dMCqBkHO1/g63xeEvIwejvtv01pas/Wva1acmi/+6Jlu3StwJ7ejyMFxFvyKNO+18NxFdDlSLtKgLy3lfC16NZ2/X0BdBx2fhP0YKLlEcZTB21Bdux1mLJf2lQHe7+bolrdu70ri2Litvvu7pfuOrj9zrgOl1dC1GXVTlovsRRjtdv4IpKxyMvpsdtPrVpr9CzbRSl/xP9NenZD7zdS8J/6ahvlPTOe4sB6MKjE3v81aN/mxaoMXhvC456WDstWTL13/ygloH7wKpivJSdpzhKnrDQl1W3t+S3dst6aik7BbtQ+oL4fL1ltraRcVdefvvDFZx+pl5o1rgVy+KrkseZTDq8rijvuTsSOPqmiwZz/0dDsF4nBzpNUZX6XX1TtqQ9YuhHTS0sxddvzKF7phVFWA67FzgLkt1MAbvkvSdotEld7o4MdPBqIRajcb1XP9NNwV3sk40GK0gLxC6Y9Se78jB6DB/YUnWrjZk51ZTWq4HaThLQeUd+KKSaf16P2fPGZHKgzFw6tlReo/asn9zs38PRBjBeJxUHozjVFq9h3uyUdgR3h+MpSttbydytUOn3+y966ErS2OaHtEpmsJiBLFp1oNRVUz+sElPsflvuund3RihxeEvQwdjie0d859h6H65khl+rGBMnuLSfjTcl9BsKa68/V8eB3cIe0+B+26YqjwYT8jiNV9r2V/0L8isuC77ZBCMx0n1wahbZV962wv+ctDJ3LE54A9GV4XnVnKH9h68bdnx9skzeG8bP67BqATCKwo9b4vD04VmksE4ROvNNx172402z3lZuznEU1y8xVN5h55kpEMv0LL0dq+ZQDBG3axGfMhIVEKnzwnGY2UCwaglj2dLdpOhi3OnnHAwek+NEYxh4eeeNu94Ki5fh/4nMhjHrOhzxV95+/uk9tRn57nQ4LjZKGMiwaiN+bSqR+pY4eabJ8KEgjGm+yo27qgdM3TXnqvkLtz7g7F0pX0op1LVN+IrxjQ9nsxTqYl390eslFTFe6XstZ7xeSvdEts7Vu2p1Ppn4TukdYmu2eu7u6/qO7Mbo1fewScZFZeihxr0TSwYY/MXN6Mf7R6lFD+UgmA8TiYajAPzUr+0Llv6lwD0zQGlglKFRubbmj8Yy9584785yAyqwPxUiyb0/Mgn9uabvvrQN0FEpeIO/TZvpatCutTNN+/5vwS0rmWHH66iDzyyrdsq+GWIcSrv0LFSUFzda2wTDsa+qOvWZnyTkuNXNpyl8HghGI+TIwrGvOjJN7d9pznsnSsQVKr07vsf3BzsrqEq5KX+8OHuGrkHDWeEHyU3UncNVfFsuMYxTE8whgPDVZwPAaiQPxhV6bWk4fl1lHB3jY7svpkdZ6iKPnRav+haWOjsSKjyDj3JyFGcHfptRxWMDvrJNzveXyopOKsTqI/KnlHCdKg4GHWn56Won1VDtw7vtaX7WFWLujXnHN7/6Kbs7d7hYIzK43b0FJBROvjbp02msoO/Kt2vNge/86jWr27dYj5NwRjs62YX8/mUExIMRl0OetK+PWIHf0cLeKiKfsQzCP79t0yrJvwko2zx3DBlqjwY56X+ptGFRf+Gpq6HHu4UXLf2PQ6vLY3/5RonUB892pfNt4x95cL4vwGL6lQbjNeKd5X2ddcvWPiCUR0gmU7RJYNx5OLoMzehR8LleLajq9iBNV3BqL4s6KcbJdMIleJrOtUpFYxjFFcL+NCC0bXfahfU8eLd6GWCUQn1STVL2d/LrDgYV74smrqatvOOd18wjtZizBXvcYejVm0wei/Y698jNFpyC8uy6btjLNfKrDYYi34vcBIPEc+55Ks48mXag7F8q7Ggkq9YpcFYcO17qGD0Bonadx/syFr6BJfoyTg7Jc5YlAxG1drxP8koLZ4zILaqW4y+m756Hdm7ap7hWfX/6HNhKzPwlC+7EIxTrfJTqcOdeiku+Uq4wmD0nr6r/men8kK/j5ct0x+MqgIK/KyULmV+zLgK1QVj8d21Q1X0Q+4P5UrZYFTKtBpL/JhxX+WnUoc8fe8pre3i692hn1nLFIJxqlV/843uHDxujjj7D1UUjIUPFDAc6g8Vh0IxFvqlA7PMQjCGpl36+lQFqgrGzpfFn/VwFf14T3JxlyGCMdgndcjfy6w8GJVAK7tMCT17eajTzATjVKs+GLXg9Q1PKXziRAXB2GvLzq/LHtBjdhZWh2nruu+h47byLdWZCMZQvzhfh/6KHX4whh4wP0JFr/e/r4as6vWxdKPoqBkmGAMt1lCHftskglHRz6/tjNKHWpeO68t5Xn275BcWgnGqTSYYtTn9UznDBYn/GYX+YNSh471WYJVoXiPc/Th/qSHNznDx2L23I+u+2/2L6G1YYp1mIRj9v9pQrq9gVfyVrtpP9FOcylawj1rSKPFla5SKXt9tuXKj5CPhuk3Z1Ptc4Y07epu75pEXOg2e/cWNEiYUjJELG8N17td3H9/a8Hb7ykqe8hXaPwjGqTa5YEwlDzyOOtTaR3TyO4zlnmofCMbkUV9Rv6TbSTcRs6h56d9a0/MKPyA4bP7CmmzqLimu9dK/6/awKXvX1wfdKsYwf2lTdl3rFM1nX3YuZ6+DTF0whn4dfsId+m2lKl3jwd12x/DoaTO3d2XzUvmfMBq5otcWVqJ9L7csyT6+d21l0Nn/SnGota+X2TcDD2ko06HfNslgTET9pm81423mOl71dtPH66h1g+cz6ek67rPVIzsjgrDJB+OhKReMmD6h/qCT7tBvG7fSPdYCj/Ur1aEfmHIEIyYscIdgqUf5VYtgLBLqquF56g4wQwhGTFagxXEUHfptBGOB0A1TZTv0A1OOYMQEhX966ig69NsIRrfQT0+V7tAPTDmCEZMT6Od1VB36bQSjQ+CHiIfq0A9MOYIRE+NvcRxdh34bwZgXumFqqA79wJQjGDEZU9yh30Yw2g65Qz8w5QhGTESwQ/8UXZ8iGLOCHfqPuHsNcNgIRlRvyjv02whGUwUd+oEpN8PBCADA4SMYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBAMAIAYCAYAQAwEIwAABgIRgAADAQjAAAGghEAAAPBCACAgWAEAMBQWTBu3ZdSpXtr1Tn+E+PtPel292TV9d6hmZeV6y3p9pKNftCT7v1d2bjgGrZicxvSVMvR+2oj83r9gz1pP44Xr/vlSua90dVk866eYkd2L7rejzn31YOutG9tyNKcMaz+rKQlW8a4AI6fybUYK65UVm91jyhkt9RalVsv5zJWHox1VfGrJOrsy+Zbi1JTr9VeXZXGva5Kp6ZsmBX/oVuVvW5X9t42XnMGo3rtQKT9ybLMq/9rczXjvTGcb0j7oC3Nuz3p3V5zD6PoYMx+LjVZfGtT9h+p5by3JYvp6wQj8EQgGMc25cH47r70DpqymQvAuuw8VHl5c9l6/TA5gtGlon1j+WZH5P6W1Aq3QSwfjIkLO9KWnuy/m/xPMAJPhOMRjHNLUSV/FME4/0FTVZ0l1qtoGSsOxpc/aUfh4Hqvtt2Srmq5vex47zDU3tDBclTBqENZpHlVtz6XZVdlZGvb3RItDMZkGu3PFuP/CUbgiTAFwViTpSt70lYVUHxtpyedOw1Zsb7dm9eg5HFb9j6ox++pyj1XvEGj57crrUfpBTc1+NdNaVyazwynK8vWtjmeFleU8evx33bJj6P4ljEJxg1z/Q7Ulrq+Ep32NKczf6mRXe4y1wmvNNX0iltLA0nLd24lPs2alN6jljR+nQ8UvSzNr7PD7V5Z6i+z67pdGj6DbevehnExWmqGRR30nV1Ztl7PSVqJG8n/UevxQWNwWtRAMAIwHXkw1lVo9Hod2buaXF9Kr3+pSqyeDqfH7bVl57K+RqaDbV+6B9kbKsqeSo3mp8bdV/Nb1GGxUJe1G231mmrZXB4EQDgYU4dwKlV9Geh19mXjDT3/eVm+qtZPBUPzymB5apf1cDowV5PlXpbNWx3pdfdl3Rt6yTXGbkt23k/W2TmcXo+OtB/0pH3DmodaGrPVFy+LHm5N6gvqtbnFaJk76rXWdvKFJaK3V77FmNu2jn1j7bZa5rub1peDuOXX/iQJqkLxTTeZ64rndevVfRNOYTByKhV4Ih1xMK7J/mNV8bxnt0jiAIpPg52QlS/VP9bpwPXbHVW5vt7/v1Qwzm1KU1XeZuCklr9QNa7REploMDoq7PWvVFh+tZ78vyiNB7rlYoZO/LpezvB1Qn1X6r60k9Zm9+uW7N9Yz95xGa2Ha1q1aFkGIRWHU+eL/DxrqnWavZY3ejDGN85Y2yVwrbBPj6ummJ1vvA1dN+Hkg9G4+Ubtd5kvaCU/awCz62iDUbc8HqsWj/laQodIPxj0dTxVSaatSntYrVQw6tOKBfM7MacrU1URvxn/P9FgdJz61cP2vwxEy6ZazOezw2i1622RhzvOU4ROuoV8dVeaHRV2PbXc/VOxcYsxXf+MqIWYnJZ8c1e3K53L0v9Cc8X8f8RgdLT6oi8LnrtLU9FpU8fp1tpV92llvTy5QncN4Il1tMHouvZmln4rsaZaPE3p6GtwqsXXfbgvO+8NrmdppYJRz6/w+qMOhkElPlXBGG07TylcJ5+kJdi/7uZbD+M9bzjY22ecYExeT4Msau27T4VmxS1aX0nPRKT08gT3Hc277gCOi6NvMQ5Zqc9fWJPNmyrCrFOipYJxpluMo1TIK7LzQLW033O9p7y3L73+vPV6TFOLUUtOIX+yGN10o09rBlvGgdOt0bVL6yYcghGA6YivMerO3qriNG56yXtdNu90ct/y7ZApFYxR5/Jy1xiz1/gSF3UoHEEwnliSna970r5uX2MMSZ78Yt7IZKjfiNd5Kfpfr8cUXWNMRKc/O83o1K/rLtWsZH1zN+0Yos8w2/IkGAGYjjgY83el6htF6u9sRRWhfhKKHiYKrf5dqarVeHFTmlHLbXB34pIeprsva9FdkrXCijG9K7V5Lb3z0n1Xary83eju1ehu2Tc2ZF8tU+/ADsbkqS3X9aldNd+ClormXMZSwajmH7Xa1BZM70pV81p8a112H/Ske3u9uC/iBRV4+nLig11Zv5h0SdHrrB8Rl1nnuMXY0QGcuys1GyT9u1Jvrsuy967UpShEu7fXMk+0GSYY01ZoqS4a0U03oQDN34RDMAIwHXkw6go+7leoKr+0dFVw6a4A/WHmVXjpijx5X98YcTOubPvTmVuV3YcqAXRRleiK+Z6l/oGjH2Our55arg+bg+eLRn0n1TxURZ8NRjU91apJl631Yfa9DNcylgxGLe47OFhuUa3t1q3NXJ/PnIUVaahWd3/7qZLvu5m0fPWwJfox1n7t6MeY9i01h7u82++f2bkZPwN1uGAs20Wj+KYbm30TDsEIwDS5YMSUK39KeKLKdtEAgENCMCIxjcHo6KgPABUjGJGYwmCMrhmW6aIBAIeHYERi+oLR93xTAKgKwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAADD1Abj0o2OSK8pG473AACoygSCsSaLlxvS/LorvQOJy0FPuvd3ZeONWmbYrfsire3476MLxlXZ63Zl7+3Ba6u3usmCG6XbkeaNdVmaM8cFAMy6ioOxJqtf6oBry/61NakvxK/XXl2WzVttFZQqgC4PwtEMxkq8vSfd7p6sut7rcwdj99aqMcy81N/Zkv2veyIdNT3C8YkXfXm6v+V8b/ptSUuy+/xwxh1/Rmy3km/Fusza+up6LVl0XWZ2X52MSoOxrnakXq8lWxd876tWYRIsVQdj7YOm9A4lGFN1tcw96d3dkFruvdmUbR2rzy59T3+pSF7NlMz2PISDL52Pa1x7GezPMlRxed/XlbtVgvvKQJlg1Pt3vxROO92Groo3WUbfcqXbyBom+7nGZXCshYLN+lyd2843fmjdA9s+9Ln3FWy7zOeuSu5zKrPfxsvorp/s5TeOm9D79rKlxV6GzDaw1s/aPq5ljD5/336DjAqDcU32H4s0r2ZPl2Yty+5D9SG/E/+fCUb9YWc+yHlZu9mWbno69nFH9j9cGgSSHv5+Q1a/0C3ReJDew92kNWcf2Kp4D67sjlccjMr5hrSlI7tvOt6bNdFBOjhoo8rMczBF7xsHcPb/uDIo3G4O6cG7Z003pqdnfi7xZzqYvn5/sOxxENjBPhg/9741/rCi6TkrVON9Y1va2y4z3H29JFbll3w2e9Z0suJt0lLj28Po6RZ/Fva2DbD2k+D4evj+uibHYmbdh9v2Q2+7DHu/sbeNXpbs+5Fo/3EtY7LNjTDKLl/ofVt++eLtXbRO8fJm6k3HsHqexZ8/bNUF45u7Ki6Gq2j0h+cOxpraeTvSvaeC71UdtPF1y1a3J80rSfDq4Xs9aX+1EV/3W1iRnQeqNXdnI34/N80iesfM7lj+SmVRdh5md/zZ5DggCw6ymFUZOoaNKip7e0cH+aD056fHTyoLZ8URTT+7P3kPdmt58tO0KpQylXNm2R3rqqYfzScp2Wlb+4hjfQbLbG1bPX6yHZ3bNNF/Ty+nNYx/H07mt63nn5SCeURyyz7c+Pl10OOXryvSbZ15vXDb5Xn3G8W5/0WfvWsZ8/PLLl/ofUtu2+brI1N+W7rWz3Fsw6u6YNQfsO/gctAfqDMY59TO9Xhf1o1hI+/tq1bhjizqv/Xw9jCXrGUotUzDBqO13DPLPoD1/3FxrVvu4LYr436IGAd59FrxQZ5yVkzJwd2fR2haUQWTvh+PO1iPZFp6Cv3PVa+vp3LOTE+xKspoe5jTy7yfrxzzr5mVl2v4mKsijJjLp+dtDePfh9PPOl1ec1nsYR2f/SjjZ5ZPj+/Z9hn2Zzl4LbTtYqH3s/tf+rnmirH+0fDp8kefQ3b5Qu+b9LCZ7RYNn5wpSIux7fKfhfla+rnYxb/+mJUWY7IzOYs5jFUZRDuG+ZpzGJs+yLI7jt7RiiuV49JiTCuMuJLRRa9T7kDNDGu8llbG/c9Kf/bmcP7K0hRVJNbBnhpUVL59K1mH/jTi/9P10UUvR7ZSsSuR0D4wmGb6fnaZ4+ml79vrFC+HMY9MmDm2byKaj2MfznxOBcGYKbllza9vdhrm9rGXrcz4iWT/yB4v5rR1cax79EUjKfZ0S2y7zPpn1t0Szado/p59rr98jnHLvK9F28aaRzLeYN+z9u1oHGOa6fGXWcfyxx5iR3yNUYXKA/Whhq4xXlZ/py3DIubwfeogMV9zDmPTO1F259UHVeFOdWyuMQ4qp0Glla38U85Kr3/gGwd2dJCm/8fTt6flYodILFshpBWda3rR+JnlS8bVLxufYyZMbNH6DPaDaJqOks4/Wh5HZTRYvmzl39rW/5vbxtzn7P8HCre9+Zr9f052Wzrn551GvC7ZdSszfjxesIK2tr37/eG3Xcq5DbUkVJz7aGaeWZn9LRouu46h9zPD2fu9Ht5eVuu19FiIinp9S/2fnX78eQe3O/oqDMYTUr/eFhn1rlQzxPSp1IO27BRMJ3IkwZjclXpvyx/aM8F18LgqGf2ao/KIKhVr2MwBbAdFscIKwqqYXBVcNK6jAstPM7Q82XXX4/sqlmhZMtN3bTuDuS9G61ZQrO1QvM7uUrR+2eXNL2t+fbKy26PM+PF+45vmQGDbme8Pse36on3V2kei1zyfsWP/ixTt9+mwofdTruH6r1vD6vE99Zj+bLKfO8E4rEqDUQfHxu18P8b5C2uydTvQj1HvEP0PX998oz7ZR/uyeXE+ej/qC/lVR7p3NuXl3PApdQCZr53fUa07FbD6wQJztYIuFmWC8Xj2Y4y2sXFwRv9b29T1Wiw++Abv5Q/GePqOysUSVfR2pRZVJubnkszPGC4OiILpR+Mb+5ercjJE0zLXMzf/rGjdjGUp3k5KUSXYVxwM3ummAhVnPH9jW+Tmp/8337fklj80fvx/uVB0bHuLfxvYy5KX27+S7eENjqL9JbctreUPvW++5tw+9nGUP65M7un4x0FexcGo1WTpvZ2hn3wT7VCZnWde1m6oXV5lUX8a9xqykoRtfnhNHSSZ15IHDujyaE9WMsOm9E6UPbDiCj1besf0yTeZdbW3p+Mgz0rCKimuA9HeloNhksrTLnbYmMVRueWKOUwSjnFxfAs3i6uSsocxppFbNmvbZd8vDuSYXblnt2u/5Pb3RC4Y7fHt4Mhv++xnbL8/3Pi5bZOU/jChbW+/X7TeEXvbBfYbJQqTXLHWMVqGgs8ttHyl3re3qSm7fbPHle+9FME4rAkEIwAAs4NgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAUG0wnjsrp//rJTn313+Sv9n9J/nG5y/JM2+dyw/3bz+K3v+b33/beu/b8ox+/b9fkKcyryf09H+3IGc/fy0e/6+/lLMf/UBO/8Qx7P/5oZzTw3z8fGZaT62+HI9rv/6b+PWzq2f7r3kly/LcX4xl+eMLcvIFx7Dpeu3+SE7l3jOEtkvOy3Jm3j3cNz/8nvH6YL0z65fOr1BgeRNPvfaCPPvpeflmNM55ee6jF+WUYzv0t70tt77KSNvXpJbjj9+Xk+esYYvW2dznDmm7AJgNFQajqsj+lFRiGa/J2d9YYTNKMD6v3vvcnK7pl/Lsr6x5nEkrS1WJnUlfPy2nP07HWZDTf5e+flJOf6hf+4Wc+Xn6mod3WVRYvWSPYyxL5nXLIQaj3ibP/PPJ/nuVBeM//yj+AmL7XI37neywpYNx5O2bZ39BIBgB2KoLxvkX5KyuNP78g8G39J/XVOvuFXn2t9/OBt3Qwfi0CrQ4dL+x/QM5tZBU+H/7tJxa/cekYrZDIg278/J0PXnt756XZ9Ww31Rhraf17H+kwfEtefovati//LBEhTdYlnMfvSCn/iFdFvXF4IOfxa2m7e9by59W3OMGY6hCTod7LV6OT1+Uk8mXAmcwmtLPr6i1XuDU7/X81Lb81en4tXNq+/z+FTm3/VM5/b+zwwaXIXJI2/cnyfrs/tj4YqQUbuMCI24XALOjumD8zvei0NEB9fS/qIrPrIxswwbjz1+U5/TrRkVvOrn2SjS9c+vfyrz+1K8Wotf7FfF//FT9/5o885sX4oD8Y9KaeEkFuP6/TGWZLsvnKkRzy6Iq9Y/06d0X5dT3zdcnHYw/ljP/mQ2hqoLx5Novoume06ct/949TKpUMB7W9u0Ho7XNCEYAlkqvMZ763S+S60zKX38mz/6/593XhNLKqYhVCaUBZwdfX1qZ/smqvNJKLbmeeOr3uiWiWjLfSU+pqkpTVb7p9ActyGLBZXE6rGC05CprYz5nzsmZT/XfC3JaBVZVwXji71UrPLmmrL90PPfxD+WM/mLkGDZdBtsz/2YMM9b2tb2WX9+Cfe/QtwuAmVHtzTfKU//+ojz7p/RGDO1n8nTdCpxJBeMJFQ5/1tNUQXEuqTyTa05xJR2fZo0D07zmWGxmglH/X49vQDr3h+/KyaqCUXvhm3L6vxbkuX5Aqnl+lL25SZtsML4kZxaT07smghGApfJg7Fv4tpz5Q3JNyK5UQgFgDz/iqVTt1Pp59d4v5MxqHBL9a2FJhXdu/cX4+mLZii90qu9jfVfmD607ZQ8rGAPj54Y7Laf+oNf/l/Lsxz+Lpl1pAJx7Wk6+9QM5G90481om8LRDOZUa3L5qmG39t5rPpaeNYRKF27gAwQgce5UF41P/olqKn56Xs7/9ljz1t8nr/zO+2SVXoQ8bjFGFGN+QUf7mm4Salw7n+Iabl6LTivF76anG+EaV8i2Uwd2339iuuW8O+bQmJzPjHFUwKs+n135jhxuM5+T0H1+Sc3/+qZx+eXBW4ORv4y8q9rxKBeNhbN+0q44rXAlGAJbqWoxpBeJw7gOrEho6GJVhu2uk+jcFKdZ00xtHXK0br3/43qF1J8jMNxiMtqLuGtkA1X00o0BRDjcYT8qpD35pLI/pZTltfVEpOpWaW9+Rt2+63mflzH/r/9Xn+n9LnsYvWm+CETj2qj2V+pPvytMfvSLfSCqbb/7lFXn2d9+Vp0p/a08quKJKaJgO/n2Dvou5UEhP20U35BivlzF2B/TYJILxxJk0KA47GJUzp+XkpR8PPhMVRue2fyynz+ev75UORm3cByiobRm1Gu3T7wQjAMvkrjECADADCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAgIFgBADAQDACAGAgGAEAMBCMAAAYCEYAAAwEIwAABoIRAAADwQgAQN8J+f/AFPAkNdyVIQAAAABJRU5ErkJggg==" alt="Client ID and secret can be seen on the Spotify developer portal"></p> <p>In the <code>application.properties</code> in the <code>resources</code> directory, we are adding the client id and secret as properties.</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spotifyPlaylist.clientId</span><span class="token punctuation">=</span><span class="token attr-value">YOUR CLIENT ID</span>
<span class="token attr-name">spotifyPlaylist.clientSecret</span><span class="token punctuation">=</span><span class="token attr-value">YOUR CLIENT SECRET</span>
</code></pre></div><p>The properties in the application.properties could also be set directly when starting the application by command line arguments.</p> <h2 id="architecture"><a href="#architecture" aria-hidden="true" class="header-anchor">#</a> Architecture</h2> <p>The following figure shows the classes, we are going to implement.</p> <p><img src="/social-playlist/assets/img/architecture.872c37a2.png" alt="Architecture of the backend"></p> <p>We can already create the model class <code>Track</code> inside the <code>domain</code> package.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Track</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> uri<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> artists<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Track</span><span class="token punctuation">(</span><span class="token class-name">String</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> artists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uri <span class="token operator">=</span> uri<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>artists <span class="token operator">=</span> artists<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* getters */</span>

<span class="token punctuation">}</span>
</code></pre></div><p>Simultaneously, we can create the <code>TrackDto</code> class inside the <code>api</code> package.
It looks very similar to the <code>Track</code> class, however it also contains a <code>map</code> method, which maps a <code>Track</code> to a <code>TrackDto</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TrackDto</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> uri<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> artists<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">TrackDto</span><span class="token punctuation">(</span><span class="token class-name">String</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> artists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>uri <span class="token operator">=</span> uri<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>artists <span class="token operator">=</span> artists<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/* getters */</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">TrackDto</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Track</span> track<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TrackDto</span><span class="token punctuation">(</span>track<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> track<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> track<span class="token punctuation">.</span><span class="token function">getArtists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>We are creating those two very similar classes, because they serve different purposes.
<code>Track</code> is used internally as an entity, which will be mapped to from the corresponding classes of the Spotify Web API.
<code>TrackDto</code> is used as the DTO, which is sent over the web by the REST controller.</p> <h2 id="login-to-the-spotify-web-api"><a href="#login-to-the-spotify-web-api" aria-hidden="true" class="header-anchor">#</a> Login to the Spotify Web API</h2> <p>We are using the Java wrapper API <a href="https://github.com/thelinmichael/spotify-web-api-java" target="_blank" rel="noopener noreferrer">thelinmichael/spotify-web-api-java<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for accessing the Web API of Spotify.</p> <p>Add the dependency to your <code>build.gradle</code> file:</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>dependencies <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    implementation <span class="token string">'se.michaelthelin.spotify:spotify-web-api-java:2.1.2'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>For accessing the API we have to authenticate the application first.
The image below shows the authentication flow for getting a token on the backend.</p> <p><img src="/social-playlist/assets/img/spotify_auth.b7a5f7a8.png" alt="Authorization Spotify API"></p> <p>When the user opens the <code>/api/login</code> endpoint with his browser, the backend should redirect him to the login page of Spotify.
After logging in on the Spotify website it redirects the user back to a defined URL, which can be chosen by the developer.
For this we add another property in the <code>application.properties</code> file.</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token attr-name">spotifyPlaylist.redirectUrl</span><span class="token punctuation">=</span><span class="token attr-value">http://localhost:8080/api/spotify-redirect</span>
</code></pre></div><p>For this application we are making some compromises, which limit the ability of our application to scale.
E.g. we are storing the token on the backend.
The way we are going to implement this, makes the application only usable for editing one user's playlist at a time.</p> <p>Now we start with the implementation.
We create the interface <code>StreamingProvider</code> inside the <code>domain</code> package.
This interface will be implemented by a class which connects to the Spotify Web API wrapper.
The goal of this abstraction is, that we could easily replace the access to the Spotify API and use Google Play Music or other streaming providers instead, if we wanted to.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StreamingProvider</span> <span class="token punctuation">{</span>

    <span class="token class-name">URI</span> <span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksOfPlaylist</span><span class="token punctuation">(</span><span class="token class-name">String</span> playlistId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>The next step is to implement this interface with the <code>SpotifyClient</code> class inside the <code>spotifyapi</code> package.</p> <p>This class connects to the Spotify Web API through the dependency we added.
You can see that we inject with <code>@Value</code> the properties we have set in <code>application.properties</code> into the constructor.
In the constructor we instantiate an object of the <code>SpotifyApi</code> class.
The <code>SpotifyApi</code> class is part of the wrapper library.</p> <p>The <code>@Component</code> annotation before the class definition is needed by Spring Boot and it will allow us to inject instances of this class as a dependency into other classes.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpotifyClient</span> <span class="token keyword">implements</span> <span class="token class-name">StreamingProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SpotifyApi</span> spotifyApi<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">SpotifyClient</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${spotifyPlaylist.clientId}&quot;</span><span class="token punctuation">)</span> <span class="token keyword">final</span> <span class="token class-name">String</span> clientId<span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${spotifyPlaylist.clientSecret}&quot;</span><span class="token punctuation">)</span> <span class="token keyword">final</span> <span class="token class-name">String</span> clientSecret<span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${spotifyPlaylist.redirectUrl}&quot;</span><span class="token punctuation">)</span> <span class="token keyword">final</span> <span class="token class-name">String</span> redirectUrl<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">URI</span> uri <span class="token operator">=</span> <span class="token class-name">SpotifyHttpManager</span><span class="token punctuation">.</span><span class="token function">makeUri</span><span class="token punctuation">(</span>redirectUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        spotifyApi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpotifyApi</span><span class="token punctuation">.</span><span class="token class-name">Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setClientId</span><span class="token punctuation">(</span>clientId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setClientSecret</span><span class="token punctuation">(</span>clientSecret<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setRedirectUri</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">URI</span> <span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksOfPlaylist</span><span class="token punctuation">(</span><span class="token class-name">String</span> playlistId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>Now we can start with implementing the methods of the interface.
We implement the method <code>getAuthorizationCodeUri</code>, which generates the URI to the Spotify login page.
This URI will contain the client id and redirect URI back to our application as parameters.
The scope tells Spotify, which access rights the user needs to grant the application for using it.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">URI</span> <span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">AuthorizationCodeUriRequest</span> authorizationCodeUriRequest <span class="token operator">=</span> spotifyApi<span class="token punctuation">.</span><span class="token function">authorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">scope</span><span class="token punctuation">(</span><span class="token string">&quot;playlist-modify&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> authorizationCodeUriRequest<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now we implement another interface <code>PlaylistProvider</code> inside the <code>domain</code> package.
This interface will be implemented by classes, which are an abstraction between the REST controller and the class which accesses the Spotify Web API.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PlaylistProvider</span> <span class="token punctuation">{</span>

    <span class="token class-name">URI</span> <span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksForPlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>As you can see this interface is pretty similar to the <code>StreamingProvider</code> interface, however, they serve different purposes.</p> <p>We implement this interface in the <code>PlaylistService</code> class inside the <code>domain</code> package, which separates the access to the Spotify API from the business logic of our application.
We inject an object of the <code>StreamingProvider</code> interface in the constructor.
Spring Boot recognizes that <code>SpotifyClient</code> is an implementation of <code>StreamingProvider</code> and will therefore inject an instance of <code>SpotifyClient</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlaylistService</span> <span class="token keyword">implements</span> <span class="token class-name">PlaylistProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">StreamingProvider</span> streamingProvider<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">PlaylistService</span><span class="token punctuation">(</span><span class="token class-name">StreamingProvider</span> streamingProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>streamingProvider <span class="token operator">=</span> streamingProvider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">URI</span> <span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> streamingProvider<span class="token punctuation">.</span><span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksForPlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>The <code>getAuthorizationCodeUri</code> method of the <code>PlaylistService</code> does nothing else than calling the corresponding method in the <code>StreamingProvider</code> implementation.</p> <p>We create a controller <code>PlaylistController</code> inside the <code>api</code> package, which will handle all the requests to our backend server.
It has to serve the <code>/api/login</code> endpoint, which redirects the user to the Spotify login page.
The URI to which the user is redirected can be received from an implementation of the <code>PlaylistProvider</code> interface, which we inject with the constructor.
This endpoint is used so that the user does not need to know the client secret from the Spotify API.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@CrossOrigin</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlaylistController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">PlaylistProvider</span> playlistProvider<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">PlaylistController</span><span class="token punctuation">(</span><span class="token class-name">PlaylistProvider</span> playlistProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>playlistProvider <span class="token operator">=</span> playlistProvider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">RedirectView</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">URI</span> uri <span class="token operator">=</span> playlistProvider<span class="token punctuation">.</span><span class="token function">getAuthorizationCodeUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedirectView</span> redirectView <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedirectView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        redirectView<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>uri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> redirectView<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/spotify-redirect&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>If you start the application now and navigate to <a href="http://localhost:8080/api/login" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/login<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in a browser you will be seeing an error message:</p> <p><code>INVALID_CLIENT: Invalid redirect URI</code></p> <p>This is because we have to whitelist all our redirect URLs on the Spotify API website.
For doing this navigate to <a href="https://developers.spotify.com/dashboard" target="_blank" rel="noopener noreferrer">https://developers.spotify.com/dashboard<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and click on your application.
Then click on the green <code>Edit settings</code> button and add a redirect URL.</p> <p><img src="/social-playlist/assets/img/spotify_redirecturi.2365a491.png" alt="Add a redirect URI on the Spotify developer dashboard"></p> <p>If you try to access <a href="http://localhost:8080/api/login" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/login<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> again, you should be redirected to the Spotify login.
Maybe you are going to be asked, if you want to give your application the permission to access your account with it.
After a successful login you should be redirected back to your backend application and should see the authorization code in your browser.</p> <p>Getting the authorization code is just an intermediate step in getting the token for gaining access to the api.
Therefore we have to implement a new method in <code>SpotifyClient</code> to receive a token from a valid auth code.
If we have the token, we can store it directly within the <code>spotifyApi</code> instance.
The token is lost when the application is restarted.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">AuthorizationCodeRequest</span> authorizationCodeRequest <span class="token operator">=</span> spotifyApi<span class="token punctuation">.</span><span class="token function">authorizationCode</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token class-name">AuthorizationCodeCredentials</span> authorizationCodeCredentials <span class="token operator">=</span> authorizationCodeRequest<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        spotifyApi<span class="token punctuation">.</span><span class="token function">setAccessToken</span><span class="token punctuation">(</span>authorizationCodeCredentials<span class="token punctuation">.</span><span class="token function">getAccessToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        spotifyApi<span class="token punctuation">.</span><span class="token function">setRefreshToken</span><span class="token punctuation">(</span>authorizationCodeCredentials<span class="token punctuation">.</span><span class="token function">getRefreshToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">SpotifyWebApiException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Error: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that we have this method, we just have to call it in the <code>PlaylistService</code> and <code>PlaylistController</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// PlaylistService</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    streamingProvider<span class="token punctuation">.</span><span class="token function">receiveToken</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// PlaylistController</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/spotify-redirect&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">redirect</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    playlistProvider<span class="token punctuation">.</span><span class="token function">receiveToken</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> code<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you restart the application and navigate to <a href="http://localhost:8080/api/login" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/login<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the application does the same thing as before.
But under the hood, the token is set in the <code>SpotifyApi</code> instance and the api now can be used for accessing playlists and tracks.</p> <h2 id="get-all-tracks-of-a-playlist-from-spotify"><a href="#get-all-tracks-of-a-playlist-from-spotify" aria-hidden="true" class="header-anchor">#</a> Get all tracks of a playlist from Spotify</h2> <p>First we create the endpoint <code>/playlists/tracks</code> for getting the tracks of a playlist in our <code>PlaylistController</code>.
We want this endpoint to return a list of tracks.
We can already call the corresponding method of the <code>PlaylistProvider</code> implementation, however, we need to map from <code>Track</code> to <code>TrackDto</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/playlists/tracks&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TrackDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksForPlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> playlistProvider<span class="token punctuation">.</span><span class="token function">getTracksForPlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">TrackDto</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">map</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Spring Boot will automatically translate the returned list of <code>TrackDto</code> to a JSON representation when calling the REST endpoint.</p> <p>We have to call the <code>getTracksOfPlaylist</code> method of the <code>StreamingProvider</code> implementation in the <code>PlaylistService</code>.
For this example we use a hardcoded playlist ID.
Create a new Spotify playlist, add some tracks and copy the ID at the end of the playlist URL.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksForPlaylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> streamingProvider<span class="token punctuation">.</span><span class="token function">getTracksOfPlaylist</span><span class="token punctuation">(</span><span class="token string">&quot;YOUR PLAYLIST ID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">EXERCISE</p> <p>Extract the playlist ID to a property.</p></div> <p>In the class <code>SpotifyClient</code> we have to implement a method for accessing playlist throught the wrapper API.
You can find examples on how to request playlist tracks from the API on <a href="https://github.com/thelinmichael/spotify-web-api-java/blob/master/examples/data/playlists/GetPlaylistsTracksExample.java" target="_blank" rel="noopener noreferrer">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>The Spotify API returns a <code>Paging</code> object which is a container for multiple <code>PlaylistTrack</code> objects.
If you look at the code of those classes it becomes clear, that we have to map the <code>Track</code> from the wrapper library inside the <code>PlaylistTrack</code> to our own <code>Track</code> entity, because that is the expected return value of the <code>getTracksOfPlaylist</code> method.
For doing this, we implement a <code>map</code> method inside <code>SpotifyClient</code> and map all entities in the <code>getTracksOfPlaylist</code> method.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Track</span> <span class="token function">map</span><span class="token punctuation">(</span>com<span class="token punctuation">.</span>wrapper<span class="token punctuation">.</span>spotify<span class="token punctuation">.</span>model_objects<span class="token punctuation">.</span>specification<span class="token punctuation">.</span><span class="token class-name">Track</span> track<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Track</span><span class="token punctuation">(</span>track<span class="token punctuation">.</span><span class="token function">getUri</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> track<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>track<span class="token punctuation">.</span><span class="token function">getArtists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">ArtistSimplified</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">getName</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Track</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTracksOfPlaylist</span><span class="token punctuation">(</span><span class="token class-name">String</span> playlistId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">GetPlaylistsTracksRequest</span> getPlaylistRequest <span class="token operator">=</span> spotifyApi<span class="token punctuation">.</span><span class="token function">getPlaylistsTracks</span><span class="token punctuation">(</span>playlistId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Paging</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PlaylistTrack</span><span class="token punctuation">&gt;</span></span> paging <span class="token operator">=</span> getPlaylistRequest<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>paging<span class="token punctuation">.</span><span class="token function">getItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">PlaylistTrack</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">getTrack</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">SpotifyClient</span><span class="token operator">:</span><span class="token operator">:</span><span class="token function">map</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">SpotifyWebApiException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Error: &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now you can start the application, <a href="http://localhost:8080/api/login" target="_blank" rel="noopener noreferrer">login<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and access the <a href="http://localhost:8080/api/playlists/tracks" target="_blank" rel="noopener noreferrer">tracks of your playlist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="tip custom-block"><p class="custom-block-title">EXERCISE</p> <ul><li>The heroku <code>config</code> commands makes it easy to manage your app’s config vars.</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>heroku config:set spotifyPlaylist.clientId<span class="token operator">=</span><span class="token operator">&lt;</span>CLIENT ID<span class="token operator">&gt;</span>
heroku config:set spotifyPlaylist.clientSecret<span class="token operator">=</span><span class="token operator">&lt;</span>CLIENT SECRET<span class="token operator">&gt;</span>
heroku config:set spotifyPlaylist.playlistId<span class="token operator">=</span><span class="token operator">&lt;</span>PLAYLIST ID<span class="token operator">&gt;</span>
heroku config:set spotifyPlaylist.redirectUrl<span class="token operator">=</span>https://<span class="token operator">&lt;</span>APPLICATION NAME<span class="token operator">&gt;</span>.herokuapp.com/api/spotify-redirect
</code></pre></div><ul><li>Push your changes to Heroku and test the application.</li></ul></div> <div class="tip custom-block"><p class="custom-block-title">EXERCISE</p> <p>Create the following endpoint:</p> <pre><code>GET /api/tracks?query={queryString}
</code></pre> <p>The request takes a GET parameter <code>query</code> which is a String.
The endpoint should search tracks which match the query and return a list of tracks.
Limit the result to 10 entries.
You can have a look at the <a href="https://github.com/thelinmichael/spotify-web-api-java/blob/master/examples/data/search/simplified/SearchTracksExample.java" target="_blank" rel="noopener noreferrer">example<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> provided by the Java wrapper Github project.</p> <p>Add the necessary methods to the interfaces.</p> <h3 id="example-call"><a href="#example-call" aria-hidden="true" class="header-anchor">#</a> Example call</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> http://localhost:8080/api/tracks?query<span class="token operator">=</span>aaa
</code></pre></div><h3 id="example-result"><a href="#example-result" aria-hidden="true" class="header-anchor">#</a> Example result</h3> <p>The call should respond with HTTP status code 200.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;uri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;spotify:track:4TI9XHuNZMQWNSN77inA3b&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Genesis (Live / AAA)&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;artists&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;Justice&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">]</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">EXERCISE</p> <p>Create a new endpoint, which allows the insertion of multiple tracks to the playlist.</p> <pre><code>POST /api/playlists/tracks
</code></pre> <p>In the body of the request the endpoint expects a list of strings, which represent the track URIs.</p> <p>Add the necessary methods to the interfaces.</p> <h3 id="example-call-2"><a href="#example-call-2" aria-hidden="true" class="header-anchor">#</a> Example call</h3> <div class="language-json extra-class"><pre class="language-json"><code>curl --header <span class="token string">&quot;Content-Type: application/json&quot;</span> \
    --request POST \
    --data '<span class="token punctuation">[</span><span class="token string">&quot;spotify:track:4TI9XHuNZMQWNSN77inA3b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;spotify:track:6dX3nqfZpmktmO26eWdYw4&quot;</span><span class="token punctuation">]</span>' \
    http<span class="token operator">:</span><span class="token comment">//localhost:8080/api/playlists/tracks</span>
</code></pre></div><h3 id="example-result-2"><a href="#example-result-2" aria-hidden="true" class="header-anchor">#</a> Example result</h3> <p>The call should respond with HTTP status code 200 and the tracks are added to the playlist.</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/social-playlist/frontend/first-angular-application.html" class="prev">
          First Angular Application
        </a></span> <span class="next"><a href="/social-playlist/frontend/consuming-the-rest-api.html">
          Consuming the REST API
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/social-playlist/assets/js/app.41029deb.js" defer></script><script src="/social-playlist/assets/js/2.5ad4ca2f.js" defer></script><script src="/social-playlist/assets/js/3.f00a2576.js" defer></script>
  </body>
</html>
